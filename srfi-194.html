<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>SRFI 194: Random data generators</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/srfi.css" type="text/css">
    <link href="/favicon.png" rel="icon" sizes="192x192" type="image/png">
  </head>

  <body>

<h1>Title</h1>

Random data generators

<h1>Author</h1>

Shiro Kawai (design), Arvydas Silanskas (implementation),John Cowan (editor and shepherd),

<h1>Status</h1>

<h1>Abstract</h1>

This SRFI defines a set of
<a href="http://srfi.schemers.org/srfi-158/srfi-158.html">SRFI 158</a>
generators and generator makers
that yield random data of specific ranges and distributions.
It is intended to be implemented on top of
<a href="http://srfi.schemers.org/srfi-27/srfi-27.html">SRFI 27</a>,
which provides the underlying source of random integers and floats.

<h1>Issues</h1>

None at present.

<h1>Rationale</h1>

<p>Most of SRFI 27 is involved with creating and managing random
sources; there are only two interfaces for getting random numbers,
namely <code>random-integer</code> to get a random but bounded
non-negative exact integer, and <code>random-real</code> to get a
random inexact real number in the unit interval.</p>

<p>However, it's very often useful to loosen these limitations, to
provide random exact integers or real numbers within any desired
range.  In order to make them easy to use, they are exposed as
generators: choose your bounds and you get a procedure which can
be called without any arguments.  This allows them to participate
freely in the SRFI 158 infrastructure.  In the same way, random
booleans, random characters chosen from a seed string, and strings
of random lengths up to a limit and with characters drawn from the
same kind of seed string are all available.</p>

<p>All these use a rectangular distribution of random numbers, but
normal, exponential, geometric, and Poisson distributions also have
their uses.  Finally, if multiple generators are available, uniform
and weighted choices can be made from them to produce a unified
output stream.</p>

<h1>Specification</h1>

<p>The argument <i>s</i> below, which is always optional, is a SRFI 27 random source.
If <i>s</i> is omitted, <code>default-random-source</code> from SRFI 27 is used.

<a name="Generators-of-primitive-data-types"></a>
<h3 class="subheading">Generators of primitive data types</h3>

<p>These generators generate uniformly distributed data.
</p>
<p>In the following examples, we use the <code>generator-&gt;list</code> procedure to show
some concrete data from the generators.
</p>
<dl>
<dt><a name="index-integers_002dbetween_0024"></a><code>(make-random-integer-generator</code><i> [ s ] lower-bound  upper-bound</i><code>)</code></dt>
<dd><p>Create exact integer generators.  Creates a generator that generates integers between
<var>lower-bound</var> (inclusive, default 0) and <var>upper-bound</var> (exclusive) uniformly.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">;; A die roller
(define die (make-random-integer-generator 1 7))

;; Roll the die 10 times
(generator-&gt;list die 10)
 &rArr; (6 6 2 4 2 5 5 1 2 2)
</pre></td></tr></table>
</dd></dl>

<dl>
<dt><a name="index-int8s"></a><code>(make-random-u8-generator</code><i>  [ s ]</i><code>)</code></dt>
<dt><a name="index-uint8s"></a><code>(make-random-s8-generator</code><i>  [ s ]</i><code>)</code></dt>
<dt><a name="index-int16s"></a><code>(make-random-u16-generator</code><i>  [ s ]</i><code>)</code></dt>
<dt><a name="index-uint16s"></a><code>(make-random-s16-generator</code><i>  [ s ]</i><code>)</code></dt>
<dt><a name="index-int32s"></a><code>(make-random-u32-generator</code><i>  [ s ]</i><code>)</code></dt>
<dt><a name="index-uint32s"></a><code>(make-random-s32-generator</code><i>  [ s ]</i><code>)</code></dt>
<dt><a name="index-int64s"></a><code>(make-random-u64-generator</code><i>  [ s ]</i><code>)</code></dt>
<dt><a name="index-uint64s"></a><code>(make-random-s64-generator</code><i>  [ s ]</i><code>)</code></dt>
<dd><p>Return uniform integer generators that generate integers in the ranges of
8, 16, 32, and 64-bit signed and unsigned integers.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(generator-&gt;list (make-random-s8-generator) 10)
 &rArr; (20 -101 50 -99 -111 -28 -19 -61 39 110)
</pre></td></tr></table>
</dd></dl>

<dt><a name="index-reals_002dbetween_0024"></a><code>(make-random-real-generator</code><i> [ s ] lower-bound upper-bound</i><code>)</code></dt>
<dd><p>Returns a generator that generates inexact real numbers uniformly.
The procedure returns reals between
lower-bound and upper-bound, both inclusive.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(define uniform-100 (make-random-real-generator 0 100))

(generator-&gt;list uniform-100 10)
 &rArr; (81.67965004942268 81.84927577572596 53.02443813660833)
</pre></td></tr></table>

<p>Note that a generator from <code>make-random-real-generator</code> can generate the upper-bound, as opposed to <code>make-random-integer-generator</code>.  If you need to exclude
the bound value, just discard it; SRFI 158 <code>gfilter</code> may come
handy.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(define generate-from-0-below-1
  (gfilter (lambda (r) (not (= r 1.0))) (make-random-real-generator 0.0 1.0)))
</pre></td></tr></table>
</dd></dl>

<dl>
<dt><a name="index-booleans"></a><code>(make-random-boolean-generator</code> <i> [ s ] </i></dt>
<dd><p>Generates boolean values (<code>#f</code> and <code>#t</code>) with equal probability.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(generator-&gt;list (make-random-boolean-generator) 10)
 &rArr; (#f #f #t #f #f #t #f #f #f #f)
</pre></td></tr></table>
</dd></dl>

<dl>
<dt><a name="index-chars_0024"></a><code>(make-random-char-generator</code><i> [ s ] string</i><code>)</code></dt>
<dd><p>Returns a generator that generates characters in <var>string</var> uniformly.
</p>
<table><tr><td>&nbsp;</td>
<td><pre class="example">
(define alphanumerics "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789")
(define alphanumeric-chars (make-random-char-generator alphanumerics))

(generator-&gt;list alphanumeric-chars 10)
 &rArr; (#\f #\m #\3 #\S #\z #\m #\x #\S #\l #\y)
</pre></td></tr></table>
</dd></dl>

<dl>
<dt><a name="index-chars_0024"></a><code>(make-random-string-generator</code><i> [ s ] string<code>)</code></i></dt>
<dd><p>Returns a generator that generates random strings whose characters are in <var>string</var>.
The strings are all less than <var>k</var> characters in length.
</p>
</dd></dl>
<dl>
<a name="Nonuniform-distributions"></a>
<h3 class="subheading">Nonuniform distributions</h3>

<dl>
<dt><a name="index-reals_002dnormal_0024"></a><code>(make-normal-generator</code><i> [ s ] [ mean [ deviation ] ]</i><code>)</code></dt>
<dd><p>Creates a generator that yields real numbers from a normal distribution
with the specified <var>mean</var> and <var>deviation</var>.  The default value of <var>mean</var> is 0.0
and <var>deviation</var> is 1.0.
</p></dd></dl>

<dl>
<dt><a name="index-reals_002dexponential_0024"></a><code>(make-exponential-generator</code><i> [ s ] mean</i><code>)</code></dt>
<dd><p>Creates a generator that yields real numbers from an exponential distribution
with the specified <var>mean</var>.
</p></dd></dl>

<dl>
<dt><a name="index-integers_002dgeometric_0024"></a><code>(make-geometric-generator</code><i> [ s ] p</i><code>)</code></dt>
<dd><p>Creates a generator that yields integers from the geometric distribution
with success probability <var>p</var> (0 &lt;= p &lt;= 1).  The mean is <code>1/p</code> and
variance is <code>(1-p)/p^2</code>.
</p></dd></dl>

<dl>
<dt><a name="index-integers_002dpoisson_0024"></a><code>(make-poisson-generator</code><i> [ s ] L</i><code>)</code></dt>
<dd><p>Creates a generator that yields integers from the Poisson distribution with
mean <var>L</var>, variance <var>L</var>.
</p></dd></dl>

<a name="Generator-operations"></a>
<h3 class="subheading">Generator operations</h3>

<dl>
<dt><a name="index-samples_002dfrom"></a><code>(gsampling</code><i> [ s ] generator</i> ...<code>)</code></dt>
<dd><p>Takes the <i>generators</i>
and returns a new generator.  Every time the resulting generator is called,
it picks one of the input generators with equal probability, then
calls it to get a value.
When all the generators are exhausted or no generators are specified,
the new generator returns an end-of-file object.
</p></dd></dl>

<dl>
<dt><a name="index-weighted_002dsamples_002dfrom"></a><code>(gweighted-sampling)</code> <i>[ s ] obj</i> ..<code>)</code>.</dt>
<dd><p>The arguments alternate between nonnegative real numbers and generators.
The real number determines the weight, or the relative probability
that the generator which follows it is chosen.  The sum of the weights doesn&rsquo;t need to
be 1.0.
When all the generators are exhausted or no generators are specified,
the new generator returns an end-of-file object.
</p></dd></dl>


<h1>Implementation</h1>

<p>The sample implementation is in the repository of this SRFI.
An R7RS library file and a separate file containing the actual
implementation are provided, along with a test file that
works with SRFI 64.  The library itself depends on
either SRFI 121 or SRFI 158, and of course SRFI 27.</p>

<h1>Acknowledgements</h1>

<p>This SRFI began life as Shiro Kawai's  specification for
<code>data.random</code>, a Gauche library.  Many of the names have
been changed to fit in better with SRFI 158 names, but the essence
is the same.  John Cowan made those and other revisions, and then
put the SRFI on the back burner until he got around to implementing
it.  Arvydas Silanskas began by asking why the next R7RS-large
ballot was so delayed, and ended up volunteering to write code for
the parts already specified.  This is his first such implementation,
and in the process of writing it he found a number of errors in the specification
as well, which John was very glad to see.</p>

<p>Thanks also to the Scheme community and especially the contributors
to the SRFI 194 mailing list.</p>

<h1>Copyright</h1>

<p>Copyright &copy; John Cowan (2020).</p> 

<p>
  Permission is hereby granted, free of charge, to any person
  obtaining a copy of this software and associated documentation files
  (the "Software"), to deal in the Software without restriction,
  including without limitation the rights to use, copy, modify, merge,
  publish, distribute, sublicense, and/or sell copies of the Software,
  and to permit persons to whom the Software is furnished to do so,
  subject to the following conditions:

<p>
  The above copyright notice and this permission notice (including the
  next paragraph) shall be included in all copies or substantial
  portions of the Software.
<p>
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
  NONINFRINGEMENT.  IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  SOFTWARE.

  <hr>
  <address>Editor: <a href="mailto:srfi-editors+at+srfi+dot+schemers+dot+org">Arthur A. Gleckler</a></address></body></html>
